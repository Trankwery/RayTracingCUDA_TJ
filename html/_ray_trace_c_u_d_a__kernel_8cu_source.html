<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>PikeReaderCUDA_TJ: Plik źródłowy D:/Moje dokumenty/RayTracingCUDA_TJ/RayTraceCUDA_kernel.cu</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">PikeReaderCUDA_TJ
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Wygenerowano przez Doxygen 1.8.6 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Szukaj');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Strona&#160;główna</span></a></li>
      <li><a href="pages.html"><span>Dodatkowe&#160;strony</span></a></li>
      <li><a href="namespaces.html"><span>Przestrzenie&#160;nazw</span></a></li>
      <li><a href="annotated.html"><span>Klasy</span></a></li>
      <li class="current"><a href="files.html"><span>Pliki</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Szukaj" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>Lista&#160;plików</span></a></li>
      <li><a href="globals.html"><span>Składowe&#160;plików</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('_ray_trace_c_u_d_a__kernel_8cu_source.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Klasy</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Przestrzenie nazw</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Pliki</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Funkcje</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Zmienne</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Definicje typów</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Wyliczenia</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Wartości wyliczeń</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Definicje</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Strony</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">RayTraceCUDA_kernel.cu</div>  </div>
</div><!--header-->
<div class="contents">
<a href="_ray_trace_c_u_d_a__kernel_8cu.html">Idź do dokumentacji tego pliku.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;</div>
<div class="line"><a name="l00005"></a><span class="lineno"><a class="line" href="_ray_trace_c_u_d_a__kernel_8cu.html#a6402e8b8594280624585b8fd643bfb65">    5</a></span>&#160;<span class="preprocessor">#define WIN32</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#include&lt;stdlib.h&gt;</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="preprocessor">#include &lt;math.h&gt;</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="preprocessor">#include &lt;float.h&gt;</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="preprocessor">#include &lt;cuda_runtime.h&gt;</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="helper__functions_8h.html">helper_functions.h</a>&gt;</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="preprocessor">#include &lt;helper_cuda.h&gt;</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="preprocessor">#include &lt;vector_types.h&gt;</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="preprocessor">#include &quot;helper_math.h&quot;</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="preprocessor">#include &quot;math_constants.h&quot;</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="rcstruct_8cuh.html">rcstruct.cuh</a>&quot;</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="_handles_structures_8cuh.html">HandlesStructures.cuh</a>&quot;</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;</div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="keyword">extern</span> <span class="stringliteral">&quot;C&quot;</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;{</div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;__device__</div>
<div class="line"><a name="l00021"></a><span class="lineno"><a class="line" href="_ray_trace_c_u_d_a__kernel_8cu.html#a2a43379900de4ef87e50b4e28da13291">   21</a></span>&#160;float3 <a class="code" href="_ray_trace_c_u_d_a__kernel_8cu.html#a2a43379900de4ef87e50b4e28da13291">findAlpha</a>( float3 <a class="code" href="_ray_tracing_8m.html#aeab71244afb687f16d8c4f5ee9d6ef0e">n</a>, float3 <a class="code" href="_ray_tracing_8m.html#ac4055e3a20b6b3af3d10590ea446ef6c">v</a>, <span class="keywordtype">float</span> <a class="code" href="_ray_tracing_8m.html#a2a792a898a039d36b908170327d38714">p</a>, <span class="keywordtype">float</span> <a class="code" href="_pike_reader_8m.html#adca714bf61ad7fb2fc07053ed7c43d40">m2</a> )</div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;{</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;    <span class="keywordtype">float</span> al1=acos(dot(n,v));</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;    <span class="keywordtype">float</span> <a class="code" href="_ray_tracing_8m.html#a5a5f29b89b53dfa902ebdc182c6407db">al2</a>;</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;    <span class="keywordflow">if</span>(p==1)</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;    {</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;        al2=asin(sin(al1)/m2);</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;    }</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;    {</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;        al2=asin(m2*sin(al1));</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;    }</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;    <span class="keywordtype">float</span> <a class="code" href="_ray_tracing_8m.html#a2eaa3649fc4ddd31850c37d3d1e035c1">bet</a>=al1-<a class="code" href="_ray_tracing_8m.html#a5a5f29b89b53dfa902ebdc182c6407db">al2</a>;</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;    float3 <a class="code" href="_pike_reader_8m.html#ad53a3643d8e9b1a361e497398d3d238c">S</a>=cross(v,n);</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;    float3 <a class="code" href="_pike_reader_8m.html#a5b2ed5ea2e1cb5d4cbbfab8a4366ed76">V2</a>;</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;    <span class="keywordflow">if</span>(length(S)==0.0<a class="code" href="_pike_reader_8m.html#a7ecaf384ab87923ea947dbb29e4e4fa9">f</a>)</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;    {</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;        V2=<a class="code" href="_ray_tracing_8m.html#ac4055e3a20b6b3af3d10590ea446ef6c">v</a>;</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;    }</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;    {</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;        <span class="keywordtype">float</span> <a class="code" href="_pike_reader_8m.html#aabc621035b24273abc351729676cf921">W</a>=S.x*S.x+S.y*S.y+S.z*S.z;</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;        float2 <a class="code" href="demosaic__mw_8m.html#a9d3d9048db16a7eee539e93e3618cbe7">B</a>=make_float2(cos(bet),cos(al2));</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;        <span class="keywordtype">float</span> Wx=(B.x*n.y-B.y*v.y)*S.z+(B.y*v.z-B.x*n.z)*S.y;</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;        <span class="keywordtype">float</span> Wy=(B.y*v.x-B.x*n.x)*S.z+(B.x*n.z-B.y*v.z)*S.x;</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;        <span class="keywordtype">float</span> Wz=(B.y*v.y-B.x*n.y)*S.x+(B.x*n.x-B.y*v.x)*S.y;</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;        V2=make_float3(Wx/W,Wy/W,Wz/W);</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;    }</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="_pike_reader_8m.html#a5b2ed5ea2e1cb5d4cbbfab8a4366ed76">V2</a>;</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;}</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;__device__</div>
<div class="line"><a name="l00053"></a><span class="lineno"><a class="line" href="_ray_trace_c_u_d_a__kernel_8cu.html#a4588a68b5fa1faa0bc3ce222f4388bc5">   53</a></span>&#160;<a class="code" href="structrcstruct.html">rcstruct</a> <a class="code" href="_ray_trace_c_u_d_a__kernel_8cu.html#a4588a68b5fa1faa0bc3ce222f4388bc5">SphereCross</a>( float3 r, float3 <a class="code" href="_pike_reader_8m.html#ac0055fa4cdc19a2690bfee3643413a7d">V</a>, <span class="keywordtype">float</span> <a class="code" href="demosaic__mw_8m.html#acb95449a94688af33f6e9bb090cf2936">R</a> )</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;{</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;    <span class="keywordtype">float</span> <a class="code" href="_pike_reader_8m.html#a3b98e2dffc6cb06a89dcb0d5c60a0206">A</a>=V.x*V.x+V.y*V.y+V.z*V.z;</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;    <span class="keywordtype">float</span> <a class="code" href="demosaic__mw_8m.html#a9d3d9048db16a7eee539e93e3618cbe7">B</a>=2.0f*dot(r,V);</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    <span class="keywordtype">float</span> <a class="code" href="_pike_reader_8m.html#aaa53ca0b650dfd85c4f59fa156f7a2cc">C</a>=r.x*r.x+r.y*r.y+r.z*r.z-R*<a class="code" href="demosaic__mw_8m.html#acb95449a94688af33f6e9bb090cf2936">R</a>;</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;    <span class="keywordtype">float</span> <a class="code" href="_pike_reader_8m.html#a350bfcb1e3cfb28ddff48ce525d4f139">D</a>=B*B-4.0f*A*<a class="code" href="_pike_reader_8m.html#aaa53ca0b650dfd85c4f59fa156f7a2cc">C</a>;</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    <a class="code" href="structrcstruct.html">rcstruct</a> <a class="code" href="_ray_tracing_8m.html#aedad1181684565670a7de27502eedcc5">rc</a>;</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    <span class="keywordflow">if</span>(D&lt;0.0<a class="code" href="_pike_reader_8m.html#a7ecaf384ab87923ea947dbb29e4e4fa9">f</a>)</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;    {</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;        rc.<a class="code" href="structrcstruct.html#a258dde96712f771f4cab63ecda915ae6">a</a>=make_float3(CUDART_NAN_F,CUDART_NAN_F,CUDART_NAN_F);</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;        rc.<a class="code" href="structrcstruct.html#ac5cbcb35bab94c569ebbc049795c2c3c">b</a>=make_float3(CUDART_NAN_F,CUDART_NAN_F,CUDART_NAN_F);</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;    }</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    {</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;        <span class="keywordtype">float</span> t1=(-B+sqrt(D))/2.0<a class="code" href="_pike_reader_8m.html#a7ecaf384ab87923ea947dbb29e4e4fa9">f</a>/A;</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;        <span class="keywordtype">float</span> t2=(-B-sqrt(D))/2.0<a class="code" href="_pike_reader_8m.html#a7ecaf384ab87923ea947dbb29e4e4fa9">f</a>/A;</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;        rc.<a class="code" href="structrcstruct.html#a258dde96712f771f4cab63ecda915ae6">a</a>=r+V*t1;</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;        rc.<a class="code" href="structrcstruct.html#ac5cbcb35bab94c569ebbc049795c2c3c">b</a>=r+V*t2;</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    }</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="_ray_tracing_8m.html#aedad1181684565670a7de27502eedcc5">rc</a>;</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;}</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;__global__</div>
<div class="line"><a name="l00089"></a><span class="lineno"><a class="line" href="_ray_trace_c_u_d_a__kernel_8cuh.html#a019fa68800a77de11df2ca791c58f6af">   89</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="_ray_trace_c_u_d_a__kernel_8cu.html#a019fa68800a77de11df2ca791c58f6af">RayTraceD</a>(<span class="keywordtype">float</span>* <a class="code" href="_pike_reader_8m.html#a9008b30888cfe384af56bc71d2714dc1">Br</a>, <span class="keywordtype">float</span>* <a class="code" href="_pike_reader_8m.html#afc718730e782c562dbdd8cbdda84fb46">Vb</a>, <span class="keywordtype">float</span>* VH, <span class="keywordtype">int</span> Vb_length, <span class="keywordtype">int</span> VH_length, <a class="code" href="struct_handles_structures.html">HandlesStructures</a> <a class="code" href="_pike_reader_8m.html#ad53a3643d8e9b1a361e497398d3d238c">S</a>, <span class="keywordtype">float</span>* <a class="code" href="_pike_reader_8m.html#a1123044b2487d93ac4f2068652cbfb8c">IC</a>, <span class="keywordtype">float</span>* <a class="code" href="_pike_reader_8m.html#a4624ad09721d379eb37b97070c9259c4">PX</a>)</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;{</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    <span class="comment">// unique block index inside a 3D block grid</span></div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> blockId = blockIdx.x <span class="comment">//1D</span></div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;        + blockIdx.y * gridDim.x <span class="comment">//2D</span></div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;        + gridDim.x * gridDim.y * blockIdx.z; <span class="comment">//3D</span></div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    uint index = __mul24(blockId,blockDim.x) + threadIdx.x;</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    <span class="comment">//float3 P[11];</span></div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    <span class="keywordflow">if</span>(index==0)</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    {</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;        <span class="comment">//P[0]=make_float3(-1,-1,-1);//error1</span></div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    }</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    uint indexi = index/Vb_length;</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    <span class="comment">//if (indexi &gt;= VH_length)</span></div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    <span class="keywordflow">if</span> (indexi &gt;= Vb_length)</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    {</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;        <span class="comment">//P[index*7]=make_float3(-100,-100,-100);//error1</span></div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;        <span class="keywordflow">return</span>;<span class="comment">//empty kernel</span></div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    }</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    uint indexj = index%Vb_length;</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    <span class="keywordflow">if</span> (indexj &gt;= Vb_length)</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    {</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;        <span class="comment">//P[index*7]=make_float3(-200,-200,-200);//error1</span></div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;        <span class="keywordflow">return</span>;<span class="comment">//critical error</span></div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    }</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;    float3 <a class="code" href="_ray_tracing_8m.html#a27f5efe14c52fa358088a3f5d31d5922">P2</a>=make_float3(Br[indexj],Vb[indexj],VH[indexi]);</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;    <span class="comment">//uint p=0;</span></div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    float3 nan3=make_float3(CUDART_NAN_F,CUDART_NAN_F,CUDART_NAN_F);</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;    <span class="comment">//Calculation of the position of the sphere&#39;s center</span></div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;    S.<a class="code" href="struct_handles_structures.html#a0dc5c6a99f556fec8ade9f41e95f0070">Cs1</a>=S.<a class="code" href="struct_handles_structures.html#a0ab513238a5cafaacaab4b04ec5b3748">l1</a>-S.<a class="code" href="struct_handles_structures.html#aa09c0ce2f61a4d2f752aee8b3b14a13c">R1</a>+S.<a class="code" href="struct_handles_structures.html#a4b889795c2b2b10970c49b1e0ded7918">g</a>;</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    S.<a class="code" href="struct_handles_structures.html#a313473c088752e95c29248457cb694ad">Cs2</a>=S.<a class="code" href="struct_handles_structures.html#a0dc5c6a99f556fec8ade9f41e95f0070">Cs1</a>+S.<a class="code" href="struct_handles_structures.html#a513e63a13885eec44d15b320bea3ca80">ll</a>+2.0f*S.<a class="code" href="struct_handles_structures.html#a97111433048144dd5da6527ca88c8e0f">R2</a>;</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    float3 <a class="code" href="_pike_reader_8m.html#af93dd7f73e57b8b17d34efa33f0f948e">P1</a> = S.<a class="code" href="struct_handles_structures.html#af56f0921488ee2057aef2d6286b84a8a">Pk</a>;<span class="comment">//droplet coordinates</span></div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    float3 <a class="code" href="_ray_tracing_8m.html#ac4055e3a20b6b3af3d10590ea446ef6c">v</a> = normalize(P2 - P1);<span class="comment">//direction vector of the line</span></div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    <span class="comment">//looking for the point of intersection of the line and lenses</span></div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;    <span class="keywordtype">float</span> <a class="code" href="_pike_reader_8m.html#ae700af75f7c86d41107aff520471f509">t</a> = (S.<a class="code" href="struct_handles_structures.html#a0ab513238a5cafaacaab4b04ec5b3748">l1</a> - P2.x)/v.x;</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    float3 <a class="code" href="_ray_tracing_8m.html#a1e290925c3c5aef593439888e5ee9309">P3</a> = P2 + t*v;<span class="comment">//Point in the plane parallel to the flat surface of the lens</span></div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    <a class="code" href="_calculate__m_8m.html#a0e1e60135616bfcf405ade0573890884">if</a> (length(make_float2(<a class="code" href="_ray_tracing_8m.html#a1e290925c3c5aef593439888e5ee9309">P3</a>.y,<a class="code" href="_ray_tracing_8m.html#a1e290925c3c5aef593439888e5ee9309">P3</a>.z)) &gt; (S.<a class="code" href="struct_handles_structures.html#a2b8072df226d9ddcd0767c4247043770">efD</a>/2))<span class="comment">//verification whether  the point inside the aperture of the lens or not</span></div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    {</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;        <span class="comment">//recalculate coordinates</span></div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;        <span class="keywordtype">float</span> Kp = length(make_float2(<a class="code" href="_ray_tracing_8m.html#a1e290925c3c5aef593439888e5ee9309">P3</a>.y,<a class="code" href="_ray_tracing_8m.html#a1e290925c3c5aef593439888e5ee9309">P3</a>.z))/(S.<a class="code" href="struct_handles_structures.html#a2b8072df226d9ddcd0767c4247043770">efD</a>/2);</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;        <a class="code" href="_ray_tracing_8m.html#a1e290925c3c5aef593439888e5ee9309">P3</a>.y/=Kp;</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;        <a class="code" href="_ray_tracing_8m.html#a1e290925c3c5aef593439888e5ee9309">P3</a>.z/=Kp;</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;        v = normalize(<a class="code" href="_ray_tracing_8m.html#a1e290925c3c5aef593439888e5ee9309">P3</a> - P1);<span class="comment">//direction vector of the line</span></div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    }</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    <span class="comment">//normal vector to the surface</span></div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;    float3 <a class="code" href="_ray_tracing_8m.html#aeab71244afb687f16d8c4f5ee9d6ef0e">n</a>=make_float3(1.0<a class="code" href="_pike_reader_8m.html#a7ecaf384ab87923ea947dbb29e4e4fa9">f</a>,0.0<a class="code" href="_pike_reader_8m.html#a7ecaf384ab87923ea947dbb29e4e4fa9">f</a>,0.0<a class="code" href="_pike_reader_8m.html#a7ecaf384ab87923ea947dbb29e4e4fa9">f</a>);</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;    float3 <a class="code" href="_ray_tracing_8m.html#a0beaea967ea7920263f0580caccb0ed2">v3</a> = <a class="code" href="_ray_trace_c_u_d_a__kernel_8cu.html#a2a43379900de4ef87e50b4e28da13291">findAlpha</a>( n, v,1,S.<a class="code" href="struct_handles_structures.html#aeae224e4a9cfa9b5ebe91605ee965e27">m2</a> );</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;    <span class="comment">//For intensity calculation</span></div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    <span class="keywordtype">float</span> P8 = acos(dot(n,v));</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    <a class="code" href="structrcstruct.html">rcstruct</a> <a class="code" href="_ray_tracing_8m.html#aedad1181684565670a7de27502eedcc5">rc</a> = <a class="code" href="_ray_trace_c_u_d_a__kernel_8cu.html#a4588a68b5fa1faa0bc3ce222f4388bc5">SphereCross</a>( make_float3( <a class="code" href="_ray_tracing_8m.html#a1e290925c3c5aef593439888e5ee9309">P3</a>.x - S.<a class="code" href="struct_handles_structures.html#a0dc5c6a99f556fec8ade9f41e95f0070">Cs1</a>, <a class="code" href="_ray_tracing_8m.html#a1e290925c3c5aef593439888e5ee9309">P3</a>.y, <a class="code" href="_ray_tracing_8m.html#a1e290925c3c5aef593439888e5ee9309">P3</a>.z ), v3,S.<a class="code" href="struct_handles_structures.html#aa09c0ce2f61a4d2f752aee8b3b14a13c">R1</a> );</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="_ray_tracing_8m.html#a9da9ecad31a80fb98272dcc7405af9af">isnan</a>(rc.<a class="code" href="structrcstruct.html#a258dde96712f771f4cab63ecda915ae6">a</a>.x))</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;    {</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;        <span class="comment">/*p=0;</span></div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;<span class="comment">        P[index*7+p++]=P1;</span></div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;<span class="comment">        P[index*7+p++]=P2;</span></div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;<span class="comment">        P[index*7+p++]=P3;</span></div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;<span class="comment">        P[index*7+p++]=nan3;</span></div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;<span class="comment">        P[index*7+p++]=nan3;</span></div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;<span class="comment">        P[index*7+p++]=nan3;</span></div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;<span class="comment">        P[index*7+p++]=nan3;*/</span></div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;        <span class="comment">//P[index*7]=make_float3(100,100,100);//error1</span></div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;    }</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;    float3 <a class="code" href="_ray_tracing_8m.html#afe83ce175095e439946163562d101dec">ns</a> = normalize(rc.<a class="code" href="structrcstruct.html#a258dde96712f771f4cab63ecda915ae6">a</a>);</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;    float3 <a class="code" href="_ray_tracing_8m.html#aaa05ec51c2d691a0b7560a330374e1c4">v4</a> = <a class="code" href="_ray_trace_c_u_d_a__kernel_8cu.html#a2a43379900de4ef87e50b4e28da13291">findAlpha</a>( ns, v3,2,S.<a class="code" href="struct_handles_structures.html#aeae224e4a9cfa9b5ebe91605ee965e27">m2</a> );</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    <span class="comment">//For intensity calculation</span></div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    <span class="keywordtype">float</span> P9 = acos(dot(ns, v3));</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;    float3 <a class="code" href="_ray_tracing_8m.html#a15f015adf595b9ddc21a25082c3aabb0">P4</a> = make_float3( rc.<a class="code" href="structrcstruct.html#a258dde96712f771f4cab63ecda915ae6">a</a>.x + S.<a class="code" href="struct_handles_structures.html#a0dc5c6a99f556fec8ade9f41e95f0070">Cs1</a>, rc.<a class="code" href="structrcstruct.html#a258dde96712f771f4cab63ecda915ae6">a</a>.y, rc.<a class="code" href="structrcstruct.html#a258dde96712f771f4cab63ecda915ae6">a</a>.z );</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;    <span class="keywordflow">if</span>(length(make_float2(rc.<a class="code" href="structrcstruct.html#a258dde96712f771f4cab63ecda915ae6">a</a>.y,rc.<a class="code" href="structrcstruct.html#a258dde96712f771f4cab63ecda915ae6">a</a>.z)) &gt; S.<a class="code" href="struct_handles_structures.html#ac837a8d228f871853a06f5d93a9002df">D</a>/2)</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;    {</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;        <span class="comment">/*p=0;</span></div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;<span class="comment">        P[index*7+p++]=P1;</span></div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;<span class="comment">        P[index*7+p++]=P2;</span></div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;<span class="comment">        P[index*7+p++]=P3;</span></div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;<span class="comment">        P[index*7+p++]=P4;</span></div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;<span class="comment">        P[index*7+p++]=nan3;</span></div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;<span class="comment">        P[index*7+p++]=nan3;</span></div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;<span class="comment">        P[index*7+p++]=nan3;*/</span></div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;        <span class="comment">//P[index*7]=make_float3(200,200,200);//error2</span></div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    }</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;    <a class="code" href="structrcstruct.html">rcstruct</a> <a class="code" href="_ray_tracing_8m.html#a3b2ca6393fc73e16fc5984d4f395f2d9">rc1</a> = <a class="code" href="_ray_trace_c_u_d_a__kernel_8cu.html#a4588a68b5fa1faa0bc3ce222f4388bc5">SphereCross</a>( make_float3(P4.x-S.<a class="code" href="struct_handles_structures.html#a313473c088752e95c29248457cb694ad">Cs2</a>,P4.y,P4.z), v4,S.<a class="code" href="struct_handles_structures.html#a97111433048144dd5da6527ca88c8e0f">R2</a> );</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="_ray_tracing_8m.html#a9da9ecad31a80fb98272dcc7405af9af">isnan</a>( rc1.<a class="code" href="structrcstruct.html#a258dde96712f771f4cab63ecda915ae6">a</a>.x ))</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;    {</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;        <span class="comment">/*p=0;</span></div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;<span class="comment">        P[index*7+p++]=P1;</span></div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;<span class="comment">        P[index*7+p++]=P2;</span></div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;<span class="comment">        P[index*7+p++]=P3;</span></div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;<span class="comment">        P[index*7+p++]=P4;</span></div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;<span class="comment">        P[index*7+p++]=nan3;</span></div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;<span class="comment">        P[index*7+p++]=nan3;</span></div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;<span class="comment">        P[index*7+p++]=nan3;*/</span></div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;        <span class="comment">//P[index*7]=make_float3(300,300,300);//error3</span></div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;    }</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;    float3 <a class="code" href="_ray_tracing_8m.html#a78d663047395fbda2ab172ef7d535a46">P5</a> = rc1.<a class="code" href="structrcstruct.html#ac5cbcb35bab94c569ebbc049795c2c3c">b</a>;</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;    P5.x = P5.x + S.<a class="code" href="struct_handles_structures.html#a313473c088752e95c29248457cb694ad">Cs2</a>;</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;    <span class="keywordflow">if</span>(length(make_float2(rc1.<a class="code" href="structrcstruct.html#ac5cbcb35bab94c569ebbc049795c2c3c">b</a>.y,rc1.<a class="code" href="structrcstruct.html#ac5cbcb35bab94c569ebbc049795c2c3c">b</a>.z)) &gt; S.<a class="code" href="struct_handles_structures.html#ac837a8d228f871853a06f5d93a9002df">D</a>/2)</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;    {</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;        <span class="comment">/*p=0;</span></div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;<span class="comment">        P[index*7+p++]=P1;</span></div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;<span class="comment">        P[index*7+p++]=P2;</span></div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;<span class="comment">        P[index*7+p++]=P3;</span></div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;<span class="comment">        P[index*7+p++]=P5;</span></div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;<span class="comment">        P[index*7+p++]=nan3;</span></div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;<span class="comment">        P[index*7+p++]=nan3;</span></div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;<span class="comment">        P[index*7+p++]=nan3;*/</span></div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;        <span class="comment">//P[index*7]=make_float3(400,400,400);//error4</span></div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;    }</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;    ns = normalize(rc1.<a class="code" href="structrcstruct.html#ac5cbcb35bab94c569ebbc049795c2c3c">b</a>);</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;    float3 <a class="code" href="_ray_tracing_8m.html#af4cc1b4cce031f2daf22087d1f6a8428">v5</a> = <a class="code" href="_ray_trace_c_u_d_a__kernel_8cu.html#a2a43379900de4ef87e50b4e28da13291">findAlpha</a>( -ns, v4,1,S.<a class="code" href="struct_handles_structures.html#aeae224e4a9cfa9b5ebe91605ee965e27">m2</a> );</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    <span class="comment">//For intensity calculation</span></div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;    <span class="keywordtype">float</span> P10 = acos(dot(-ns, v4));</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;    <span class="keywordtype">float</span> <a class="code" href="_ray_tracing_8m.html#aee34fc740f3a5271508e6499ce2e3326">X</a> = S.<a class="code" href="struct_handles_structures.html#a0ab513238a5cafaacaab4b04ec5b3748">l1</a> + 2*S.<a class="code" href="struct_handles_structures.html#a4b889795c2b2b10970c49b1e0ded7918">g</a> + S.<a class="code" href="struct_handles_structures.html#a513e63a13885eec44d15b320bea3ca80">ll</a>;</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;    t = ( X - P5.x ) / v5.x;</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;    float3 <a class="code" href="_ray_tracing_8m.html#a48b1e0f0f342c6a0720585b62d204ef2">P6</a> = P5 + v5*t;</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;    float3 <a class="code" href="_ray_tracing_8m.html#a59dd33f2aa8046ea67bba3fad7a09e8e">v6</a> = <a class="code" href="_ray_trace_c_u_d_a__kernel_8cu.html#a2a43379900de4ef87e50b4e28da13291">findAlpha</a>( n, v5,2,S.<a class="code" href="struct_handles_structures.html#aeae224e4a9cfa9b5ebe91605ee965e27">m2</a> );</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;    <span class="comment">//For intensity calculation</span></div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;    <span class="keywordtype">float</span> P11 = acos(dot(n, v5));</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;    t = (S.<a class="code" href="struct_handles_structures.html#aadeae533b2b49095f2eb151282a11609">lCCD</a> - <a class="code" href="_ray_tracing_8m.html#a48b1e0f0f342c6a0720585b62d204ef2">P6</a>.x ) / <a class="code" href="_ray_tracing_8m.html#a59dd33f2aa8046ea67bba3fad7a09e8e">v6</a>.x;</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;    float3 <a class="code" href="_ray_tracing_8m.html#aa20240d26ace6829859aba913f892152">P7</a> = <a class="code" href="_ray_tracing_8m.html#a48b1e0f0f342c6a0720585b62d204ef2">P6</a> + <a class="code" href="_ray_tracing_8m.html#a59dd33f2aa8046ea67bba3fad7a09e8e">v6</a>*t;</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;    <span class="comment">/*p=0;</span></div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;<span class="comment">    P[index*7+p++]=P1;</span></div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;<span class="comment">    P[index*7+p++]=P2;</span></div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;<span class="comment">    P[index*7+p++]=P3;</span></div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;<span class="comment">    P[index*7+p++]=P4;</span></div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;<span class="comment">    P[index*7+p++]=P5;</span></div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;<span class="comment">    P[index*7+p++]=P6;</span></div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;<span class="comment">    P[index*7+p++]=P7;*/</span></div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;    <span class="comment">/*if(IM==NULL || IM==0)</span></div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;<span class="comment">    {</span></div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;<span class="comment">        //P[index*7]=make_float3(500,500,500);//error5</span></div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;<span class="comment">        return;//no need to calculate image</span></div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;<span class="comment">    }*/</span></div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;    <span class="comment">/*float dist=length(P1-P2)+length(P2-P3)+</span></div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;<span class="comment">                length(P3-P4)+length(P4-P5)+</span></div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;<span class="comment">                length(P5-P6)+length(P6-P7);</span></div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;<span class="comment">    float3 vR = normalize(P7-P6);</span></div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;<span class="comment">    float alp = acos(dot(make_float3(1,0,0),vR));*/</span></div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;    <span class="keywordtype">float</span> <a class="code" href="_pike_reader_8m.html#aabc621035b24273abc351729676cf921">W</a>  = S.<a class="code" href="struct_handles_structures.html#af4df2528600b8cb615ad4a1718f9b877">shX</a> + ( S.<a class="code" href="struct_handles_structures.html#ae99c25c83aa394b3e24d1d355d6fd8e3">CCDW</a>/2.0f +<a class="code" href="_ray_tracing_8m.html#aa20240d26ace6829859aba913f892152">P7</a>.y)/S.<a class="code" href="struct_handles_structures.html#a3a8ce068f7b233ac206378f07e37334f">PixSize</a> - 1.0f;</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;    <span class="keywordflow">if</span>(round(<a class="code" href="_pike_reader_8m.html#aabc621035b24273abc351729676cf921">W</a>)&gt;=640 || round(<a class="code" href="_pike_reader_8m.html#aabc621035b24273abc351729676cf921">W</a>)&lt;0)</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;    <span class="keywordtype">float</span> <a class="code" href="_pike_reader_8m.html#a7e55b80aae57454b1b0353641cb67b33">Hi</a> = S.<a class="code" href="struct_handles_structures.html#ace7460e892f86901584256e61393e6e5">shY</a> + ( S.<a class="code" href="struct_handles_structures.html#a4a303d7f683bcb740702abe769b4b32b">CCDH</a>/2.0f +<a class="code" href="_ray_tracing_8m.html#aa20240d26ace6829859aba913f892152">P7</a>.z)/S.<a class="code" href="struct_handles_structures.html#a3a8ce068f7b233ac206378f07e37334f">PixSize</a> - 1.0f;</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;    <span class="keywordflow">if</span>(round(Hi)&gt;=480 || round(Hi)&lt;0)</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;    <span class="comment">//float value=cos(alp)/(dist*dist);</span></div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;    <span class="comment">//Recording position of rays and a number of rays that walk into the cell</span></div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;    <span class="keywordtype">float</span> value=1.0f;</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;    <span class="keywordtype">float</span>* val0;</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;    val0=(<span class="keywordtype">float</span>*)PX+(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>)round(Hi)*4+(<span class="keywordtype">unsigned</span> int)round(<a class="code" href="_pike_reader_8m.html#aabc621035b24273abc351729676cf921">W</a>)*480*4;</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;    atomicAdd(val0, P2.x);</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;    val0=(<span class="keywordtype">float</span>*)PX+1+(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>)round(Hi)*4+(<span class="keywordtype">unsigned</span> int)round(<a class="code" href="_pike_reader_8m.html#aabc621035b24273abc351729676cf921">W</a>)*480*4;</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;    atomicAdd(val0, P2.y);</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;    val0=(<span class="keywordtype">float</span>*)PX+2+(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>)round(Hi)*4+(<span class="keywordtype">unsigned</span> int)round(<a class="code" href="_pike_reader_8m.html#aabc621035b24273abc351729676cf921">W</a>)*480*4;</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;    atomicAdd(val0, P2.z);</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;    val0=(<span class="keywordtype">float</span>*)PX+3+(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>)round(Hi)*4+(<span class="keywordtype">unsigned</span> int)round(<a class="code" href="_pike_reader_8m.html#aabc621035b24273abc351729676cf921">W</a>)*480*4;</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;    atomicAdd(val0, value);<span class="comment">//+1</span></div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;    <span class="comment">//The calculation of energy loss,  caused by reflection on lens surfaces and rising distance</span></div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;    value=0.01f*(length(P1-P2) + length(P2-<a class="code" href="_ray_tracing_8m.html#a1e290925c3c5aef593439888e5ee9309">P3</a>));</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;    value*=value;<span class="comment">//fast square</span></div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;    <span class="keywordtype">float</span> <a class="code" href="_pike_reader_8m.html#ad7d8756ffc9df06bb6bb864280ffc5d3">Ka1</a> = cos(P8)/value;</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;    <span class="comment">//KA1[index]=Ka1;</span></div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;    value=0.01f*length(<a class="code" href="_ray_tracing_8m.html#a1e290925c3c5aef593439888e5ee9309">P3</a>-P4);</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;    value*=value;</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;    <span class="keywordtype">float</span> <a class="code" href="_pike_reader_8m.html#a580628da7b9cb7e817437cacb89c8300">Ka2</a> = Ka1*cos(P9)/value;</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;    <span class="comment">//KA1[index]=Ka2;</span></div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;    value=0.01f*length(P4-P5);</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;    value*=value;</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;    <span class="keywordtype">float</span> <a class="code" href="_pike_reader_8m.html#a3cb4559b90e7cbf954590f076bdbed81">Ka3</a> = Ka2*cos(P10)/value;</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;    <span class="comment">//KA1[index]=Ka3;</span></div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;    value=cos(P11);<span class="comment">//in calculation intensive code calculating same cosine twice isn&#39;t wise</span></div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;    value*=value;</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;    <span class="keywordtype">float</span> <a class="code" href="_pike_reader_8m.html#ad30dfa987bf399e9d5c8256815544151">Ka4</a> = Ka3*value;</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;    value=0.01f*(length(P5-<a class="code" href="_ray_tracing_8m.html#a48b1e0f0f342c6a0720585b62d204ef2">P6</a>) + length(<a class="code" href="_ray_tracing_8m.html#a48b1e0f0f342c6a0720585b62d204ef2">P6</a>-<a class="code" href="_ray_tracing_8m.html#aa20240d26ace6829859aba913f892152">P7</a>));</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;    value*=value;</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;    Ka4/=value;</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;    <span class="comment">//KA1[index]=Ka4;</span></div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;    value=1.0f/<a class="code" href="_pike_reader_8m.html#ad30dfa987bf399e9d5c8256815544151">Ka4</a>;</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;    <span class="comment">//KA1[index]=value;</span></div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;    val0=IC+(<span class="keywordtype">unsigned</span> int)round(Hi)+(<span class="keywordtype">unsigned</span> int)round(<a class="code" href="_pike_reader_8m.html#aabc621035b24273abc351729676cf921">W</a>)*480;</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;    atomicAdd(val0, value);</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;    <span class="comment">//val0=&amp;KA1[indexi];</span></div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;    <span class="comment">//value=1.0f;</span></div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;    <span class="comment">//atomicAdd(val0, value);</span></div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;    <span class="comment">//float* val0=IM+(unsigned int)round(Hi)+(unsigned int)round(W)*480;</span></div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;    <span class="comment">//atomicAdd(val0, value);</span></div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;}</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;}<span class="comment">//extern &quot;C&quot;</span></div>
<div class="ttc" id="_pike_reader_8m_html_a1123044b2487d93ac4f2068652cbfb8c"><div class="ttname"><a href="_pike_reader_8m.html#a1123044b2487d93ac4f2068652cbfb8c">IC</a></div><div class="ttdeci">IC</div><div class="ttdef"><b>Definition:</b> <a href="_pike_reader_8m_source.html#l00374">PikeReader.m:374</a></div></div>
<div class="ttc" id="demosaic__mw_8m_html_acb95449a94688af33f6e9bb090cf2936"><div class="ttname"><a href="demosaic__mw_8m.html#acb95449a94688af33f6e9bb090cf2936">R</a></div><div class="ttdeci">R</div><div class="ttdef"><b>Definition:</b> <a href="demosaic__mw_8m_source.html#l00004">demosaic_mw.m:4</a></div></div>
<div class="ttc" id="_pike_reader_8m_html_a3b98e2dffc6cb06a89dcb0d5c60a0206"><div class="ttname"><a href="_pike_reader_8m.html#a3b98e2dffc6cb06a89dcb0d5c60a0206">A</a></div><div class="ttdeci">A</div><div class="ttdef"><b>Definition:</b> <a href="_pike_reader_8m_source.html#l00242">PikeReader.m:242</a></div></div>
<div class="ttc" id="structrcstruct_html_a258dde96712f771f4cab63ecda915ae6"><div class="ttname"><a href="structrcstruct.html#a258dde96712f771f4cab63ecda915ae6">rcstruct::a</a></div><div class="ttdeci">float3 a</div><div class="ttdef"><b>Definition:</b> <a href="rcstruct_8cuh_source.html#l00006">rcstruct.cuh:6</a></div></div>
<div class="ttc" id="_pike_reader_8m_html_a5b2ed5ea2e1cb5d4cbbfab8a4366ed76"><div class="ttname"><a href="_pike_reader_8m.html#a5b2ed5ea2e1cb5d4cbbfab8a4366ed76">V2</a></div><div class="ttdeci">directing vector from origin to point V2</div><div class="ttdef"><b>Definition:</b> <a href="_pike_reader_8m_source.html#l00268">PikeReader.m:268</a></div></div>
<div class="ttc" id="_pike_reader_8m_html_afc718730e782c562dbdd8cbdda84fb46"><div class="ttname"><a href="_pike_reader_8m.html#afc718730e782c562dbdd8cbdda84fb46">Vb</a></div><div class="ttdeci">Vb</div><div class="ttdef"><b>Definition:</b> <a href="_pike_reader_8m_source.html#l00373">PikeReader.m:373</a></div></div>
<div class="ttc" id="_ray_trace_c_u_d_a__kernel_8cu_html_a4588a68b5fa1faa0bc3ce222f4388bc5"><div class="ttname"><a href="_ray_trace_c_u_d_a__kernel_8cu.html#a4588a68b5fa1faa0bc3ce222f4388bc5">SphereCross</a></div><div class="ttdeci">__device__ rcstruct SphereCross(float3 r, float3 V, float R)</div><div class="ttdef"><b>Definition:</b> <a href="_ray_trace_c_u_d_a__kernel_8cu_source.html#l00053">RayTraceCUDA_kernel.cu:53</a></div></div>
<div class="ttc" id="structrcstruct_html"><div class="ttname"><a href="structrcstruct.html">rcstruct</a></div><div class="ttdoc">structure of 2 float3 </div><div class="ttdef"><b>Definition:</b> <a href="rcstruct_8cuh_source.html#l00004">rcstruct.cuh:4</a></div></div>
<div class="ttc" id="_ray_tracing_8m_html_a15f015adf595b9ddc21a25082c3aabb0"><div class="ttname"><a href="_ray_tracing_8m.html#a15f015adf595b9ddc21a25082c3aabb0">P4</a></div><div class="ttdeci">P4</div><div class="ttdef"><b>Definition:</b> <a href="_ray_tracing_8m_source.html#l00055">RayTracing.m:55</a></div></div>
<div class="ttc" id="struct_handles_structures_html"><div class="ttname"><a href="struct_handles_structures.html">HandlesStructures</a></div><div class="ttdoc">Structure with handles data used by raytracing. Structure should be filled with data from matlab on i...</div><div class="ttdef"><b>Definition:</b> <a href="_handles_structures_8cuh_source.html#l00006">HandlesStructures.cuh:6</a></div></div>
<div class="ttc" id="_ray_trace_c_u_d_a__kernel_8cu_html_a019fa68800a77de11df2ca791c58f6af"><div class="ttname"><a href="_ray_trace_c_u_d_a__kernel_8cu.html#a019fa68800a77de11df2ca791c58f6af">RayTraceD</a></div><div class="ttdeci">__global__ void RayTraceD(float *Br, float *Vb, float *VH, int Vb_length, int VH_length, HandlesStructures S, float *IC, float *PX)</div><div class="ttdoc">RayTrace CUDA kernel function. </div><div class="ttdef"><b>Definition:</b> <a href="_ray_trace_c_u_d_a__kernel_8cu_source.html#l00089">RayTraceCUDA_kernel.cu:89</a></div></div>
<div class="ttc" id="_ray_tracing_8m_html_aeab71244afb687f16d8c4f5ee9d6ef0e"><div class="ttname"><a href="_ray_tracing_8m.html#aeab71244afb687f16d8c4f5ee9d6ef0e">n</a></div><div class="ttdeci">return end normal vector to the surface n</div><div class="ttdef"><b>Definition:</b> <a href="_ray_tracing_8m_source.html#l00036">RayTracing.m:36</a></div></div>
<div class="ttc" id="struct_handles_structures_html_af4df2528600b8cb615ad4a1718f9b877"><div class="ttname"><a href="struct_handles_structures.html#af4df2528600b8cb615ad4a1718f9b877">HandlesStructures::shX</a></div><div class="ttdeci">float shX</div><div class="ttdef"><b>Definition:</b> <a href="_handles_structures_8cuh_source.html#l00030">HandlesStructures.cuh:30</a></div></div>
<div class="ttc" id="_calculate__m_8m_html_a0e1e60135616bfcf405ade0573890884"><div class="ttname"><a href="_calculate__m_8m.html#a0e1e60135616bfcf405ade0573890884">if</a></div><div class="ttdeci">if((0&lt;=Temperature)&amp;&amp;(Temperature&lt;=40))%Thiesen formula for 0-40 degC from Tanaka b1</div></div>
<div class="ttc" id="_ray_tracing_8m_html_af4cc1b4cce031f2daf22087d1f6a8428"><div class="ttname"><a href="_ray_tracing_8m.html#af4cc1b4cce031f2daf22087d1f6a8428">v5</a></div><div class="ttdeci">v5</div><div class="ttdef"><b>Definition:</b> <a href="_ray_tracing_8m_source.html#l00089">RayTracing.m:89</a></div></div>
<div class="ttc" id="struct_handles_structures_html_a4a303d7f683bcb740702abe769b4b32b"><div class="ttname"><a href="struct_handles_structures.html#a4a303d7f683bcb740702abe769b4b32b">HandlesStructures::CCDH</a></div><div class="ttdeci">float CCDH</div><div class="ttdef"><b>Definition:</b> <a href="_handles_structures_8cuh_source.html#l00022">HandlesStructures.cuh:22</a></div></div>
<div class="ttc" id="_pike_reader_8m_html_a3cb4559b90e7cbf954590f076bdbed81"><div class="ttname"><a href="_pike_reader_8m.html#a3cb4559b90e7cbf954590f076bdbed81">Ka3</a></div><div class="ttdeci">Ka3</div><div class="ttdef"><b>Definition:</b> <a href="_pike_reader_8m_source.html#l00454">PikeReader.m:454</a></div></div>
<div class="ttc" id="rcstruct_8cuh_html"><div class="ttname"><a href="rcstruct_8cuh.html">rcstruct.cuh</a></div></div>
<div class="ttc" id="_pike_reader_8m_html_aaa53ca0b650dfd85c4f59fa156f7a2cc"><div class="ttname"><a href="_pike_reader_8m.html#aaa53ca0b650dfd85c4f59fa156f7a2cc">C</a></div><div class="ttdeci">C</div><div class="ttdef"><b>Definition:</b> <a href="_pike_reader_8m_source.html#l00244">PikeReader.m:244</a></div></div>
<div class="ttc" id="_ray_tracing_8m_html_a1e290925c3c5aef593439888e5ee9309"><div class="ttname"><a href="_ray_tracing_8m.html#a1e290925c3c5aef593439888e5ee9309">P3</a></div><div class="ttdeci">P3</div><div class="ttdef"><b>Definition:</b> <a href="_ray_tracing_8m_source.html#l00018">RayTracing.m:18</a></div></div>
<div class="ttc" id="struct_handles_structures_html_aeae224e4a9cfa9b5ebe91605ee965e27"><div class="ttname"><a href="struct_handles_structures.html#aeae224e4a9cfa9b5ebe91605ee965e27">HandlesStructures::m2</a></div><div class="ttdeci">float m2</div><div class="ttdef"><b>Definition:</b> <a href="_handles_structures_8cuh_source.html#l00029">HandlesStructures.cuh:29</a></div></div>
<div class="ttc" id="_ray_tracing_8m_html_aedad1181684565670a7de27502eedcc5"><div class="ttname"><a href="_ray_tracing_8m.html#aedad1181684565670a7de27502eedcc5">rc</a></div><div class="ttdeci">Isczem pereseczenie so sferoj rc</div><div class="ttdef"><b>Definition:</b> <a href="_ray_tracing_8m_source.html#l00043">RayTracing.m:43</a></div></div>
<div class="ttc" id="_ray_tracing_8m_html_a3b2ca6393fc73e16fc5984d4f395f2d9"><div class="ttname"><a href="_ray_tracing_8m.html#a3b2ca6393fc73e16fc5984d4f395f2d9">rc1</a></div><div class="ttdeci">rc1(2, 1)-toczka pereseczenija kogda sfera nachoditsia w naczale%koordinat%x0</div></div>
<div class="ttc" id="_pike_reader_8m_html_a4624ad09721d379eb37b97070c9259c4"><div class="ttname"><a href="_pike_reader_8m.html#a4624ad09721d379eb37b97070c9259c4">PX</a></div><div class="ttdeci">PX</div><div class="ttdef"><b>Definition:</b> <a href="_pike_reader_8m_source.html#l00375">PikeReader.m:375</a></div></div>
<div class="ttc" id="structrcstruct_html_ac5cbcb35bab94c569ebbc049795c2c3c"><div class="ttname"><a href="structrcstruct.html#ac5cbcb35bab94c569ebbc049795c2c3c">rcstruct::b</a></div><div class="ttdeci">float3 b</div><div class="ttdef"><b>Definition:</b> <a href="rcstruct_8cuh_source.html#l00007">rcstruct.cuh:7</a></div></div>
<div class="ttc" id="struct_handles_structures_html_aadeae533b2b49095f2eb151282a11609"><div class="ttname"><a href="struct_handles_structures.html#aadeae533b2b49095f2eb151282a11609">HandlesStructures::lCCD</a></div><div class="ttdeci">float lCCD</div><div class="ttdef"><b>Definition:</b> <a href="_handles_structures_8cuh_source.html#l00018">HandlesStructures.cuh:18</a></div></div>
<div class="ttc" id="struct_handles_structures_html_a0dc5c6a99f556fec8ade9f41e95f0070"><div class="ttname"><a href="struct_handles_structures.html#a0dc5c6a99f556fec8ade9f41e95f0070">HandlesStructures::Cs1</a></div><div class="ttdeci">float Cs1</div><div class="ttdef"><b>Definition:</b> <a href="_handles_structures_8cuh_source.html#l00027">HandlesStructures.cuh:27</a></div></div>
<div class="ttc" id="_ray_tracing_8m_html_ac4055e3a20b6b3af3d10590ea446ef6c"><div class="ttname"><a href="_ray_tracing_8m.html#ac4055e3a20b6b3af3d10590ea446ef6c">v</a></div><div class="ttdeci">droplet coordinates v</div><div class="ttdef"><b>Definition:</b> <a href="_ray_tracing_8m_source.html#l00014">RayTracing.m:14</a></div></div>
<div class="ttc" id="_ray_tracing_8m_html_a5a5f29b89b53dfa902ebdc182c6407db"><div class="ttname"><a href="_ray_tracing_8m.html#a5a5f29b89b53dfa902ebdc182c6407db">al2</a></div><div class="ttdeci">else al2</div><div class="ttdef"><b>Definition:</b> <a href="_ray_tracing_8m_source.html#l00130">RayTracing.m:130</a></div></div>
<div class="ttc" id="_ray_tracing_8m_html_a27f5efe14c52fa358088a3f5d31d5922"><div class="ttname"><a href="_ray_tracing_8m.html#a27f5efe14c52fa358088a3f5d31d5922">P2</a></div><div class="ttdeci">P2</div><div class="ttdef"><b>Definition:</b> <a href="_ray_tracing_8m_source.html#l00032">RayTracing.m:32</a></div></div>
<div class="ttc" id="_ray_tracing_8m_html_a2eaa3649fc4ddd31850c37d3d1e035c1"><div class="ttname"><a href="_ray_tracing_8m.html#a2eaa3649fc4ddd31850c37d3d1e035c1">bet</a></div><div class="ttdeci">end rasscitywajem ugol mezdu V1 i V2 bet</div><div class="ttdef"><b>Definition:</b> <a href="_ray_tracing_8m_source.html#l00133">RayTracing.m:133</a></div></div>
<div class="ttc" id="_pike_reader_8m_html_ad7d8756ffc9df06bb6bb864280ffc5d3"><div class="ttname"><a href="_pike_reader_8m.html#ad7d8756ffc9df06bb6bb864280ffc5d3">Ka1</a></div><div class="ttdeci">The calculation of energy caused by reflection on lens surfaces and rising distance Ka1</div><div class="ttdef"><b>Definition:</b> <a href="_pike_reader_8m_source.html#l00450">PikeReader.m:450</a></div></div>
<div class="ttc" id="_ray_tracing_8m_html_a59dd33f2aa8046ea67bba3fad7a09e8e"><div class="ttname"><a href="_ray_tracing_8m.html#a59dd33f2aa8046ea67bba3fad7a09e8e">v6</a></div><div class="ttdeci">v6</div><div class="ttdef"><b>Definition:</b> <a href="_ray_tracing_8m_source.html#l00102">RayTracing.m:102</a></div></div>
<div class="ttc" id="struct_handles_structures_html_af56f0921488ee2057aef2d6286b84a8a"><div class="ttname"><a href="struct_handles_structures.html#af56f0921488ee2057aef2d6286b84a8a">HandlesStructures::Pk</a></div><div class="ttdeci">float3 Pk</div><div class="ttdef"><b>Definition:</b> <a href="_handles_structures_8cuh_source.html#l00025">HandlesStructures.cuh:25</a></div></div>
<div class="ttc" id="_ray_tracing_8m_html_a9da9ecad31a80fb98272dcc7405af9af"><div class="ttname"><a href="_ray_tracing_8m.html#a9da9ecad31a80fb98272dcc7405af9af">isnan</a></div><div class="ttdeci">Proweriajem popal li lucz w linzu if isnan(rc)%lucz nie peresek sferu P</div></div>
<div class="ttc" id="_pike_reader_8m_html_af93dd7f73e57b8b17d34efa33f0f948e"><div class="ttname"><a href="_pike_reader_8m.html#af93dd7f73e57b8b17d34efa33f0f948e">P1</a></div><div class="ttdeci">P1</div><div class="ttdef"><b>Definition:</b> <a href="_pike_reader_8m_source.html#l00319">PikeReader.m:319</a></div></div>
<div class="ttc" id="_handles_structures_8cuh_html"><div class="ttname"><a href="_handles_structures_8cuh.html">HandlesStructures.cuh</a></div></div>
<div class="ttc" id="_ray_tracing_8m_html_aaa05ec51c2d691a0b7560a330374e1c4"><div class="ttname"><a href="_ray_tracing_8m.html#aaa05ec51c2d691a0b7560a330374e1c4">v4</a></div><div class="ttdeci">v4</div><div class="ttdef"><b>Definition:</b> <a href="_ray_tracing_8m_source.html#l00052">RayTracing.m:52</a></div></div>
<div class="ttc" id="struct_handles_structures_html_a313473c088752e95c29248457cb694ad"><div class="ttname"><a href="struct_handles_structures.html#a313473c088752e95c29248457cb694ad">HandlesStructures::Cs2</a></div><div class="ttdeci">float Cs2</div><div class="ttdef"><b>Definition:</b> <a href="_handles_structures_8cuh_source.html#l00028">HandlesStructures.cuh:28</a></div></div>
<div class="ttc" id="struct_handles_structures_html_aa09c0ce2f61a4d2f752aee8b3b14a13c"><div class="ttname"><a href="struct_handles_structures.html#aa09c0ce2f61a4d2f752aee8b3b14a13c">HandlesStructures::R1</a></div><div class="ttdeci">float R1</div><div class="ttdef"><b>Definition:</b> <a href="_handles_structures_8cuh_source.html#l00011">HandlesStructures.cuh:11</a></div></div>
<div class="ttc" id="_pike_reader_8m_html_adca714bf61ad7fb2fc07053ed7c43d40"><div class="ttname"><a href="_pike_reader_8m.html#adca714bf61ad7fb2fc07053ed7c43d40">m2</a></div><div class="ttdeci">handles S m2</div><div class="ttdef"><b>Definition:</b> <a href="_pike_reader_8m_source.html#l00166">PikeReader.m:166</a></div></div>
<div class="ttc" id="_ray_trace_c_u_d_a__kernel_8cu_html_a2a43379900de4ef87e50b4e28da13291"><div class="ttname"><a href="_ray_trace_c_u_d_a__kernel_8cu.html#a2a43379900de4ef87e50b4e28da13291">findAlpha</a></div><div class="ttdeci">__device__ float3 findAlpha(float3 n, float3 v, float p, float m2)</div><div class="ttdef"><b>Definition:</b> <a href="_ray_trace_c_u_d_a__kernel_8cu_source.html#l00021">RayTraceCUDA_kernel.cu:21</a></div></div>
<div class="ttc" id="_ray_tracing_8m_html_afe83ce175095e439946163562d101dec"><div class="ttname"><a href="_ray_tracing_8m.html#afe83ce175095e439946163562d101dec">ns</a></div><div class="ttdeci">return end stroim normal w punktie pereseczenija ns</div><div class="ttdef"><b>Definition:</b> <a href="_ray_tracing_8m_source.html#l00051">RayTracing.m:51</a></div></div>
<div class="ttc" id="struct_handles_structures_html_a513e63a13885eec44d15b320bea3ca80"><div class="ttname"><a href="struct_handles_structures.html#a513e63a13885eec44d15b320bea3ca80">HandlesStructures::ll</a></div><div class="ttdeci">float ll</div><div class="ttdef"><b>Definition:</b> <a href="_handles_structures_8cuh_source.html#l00016">HandlesStructures.cuh:16</a></div></div>
<div class="ttc" id="_ray_tracing_8m_html_a48b1e0f0f342c6a0720585b62d204ef2"><div class="ttname"><a href="_ray_tracing_8m.html#a48b1e0f0f342c6a0720585b62d204ef2">P6</a></div><div class="ttdeci">P6</div><div class="ttdef"><b>Definition:</b> <a href="_ray_tracing_8m_source.html#l00100">RayTracing.m:100</a></div></div>
<div class="ttc" id="struct_handles_structures_html_ac837a8d228f871853a06f5d93a9002df"><div class="ttname"><a href="struct_handles_structures.html#ac837a8d228f871853a06f5d93a9002df">HandlesStructures::D</a></div><div class="ttdeci">float D</div><div class="ttdef"><b>Definition:</b> <a href="_handles_structures_8cuh_source.html#l00009">HandlesStructures.cuh:9</a></div></div>
<div class="ttc" id="_pike_reader_8m_html_aabc621035b24273abc351729676cf921"><div class="ttname"><a href="_pike_reader_8m.html#aabc621035b24273abc351729676cf921">W</a></div><div class="ttdeci">shifting of mask position according experimental data W</div><div class="ttdef"><b>Definition:</b> <a href="_pike_reader_8m_source.html#l00439">PikeReader.m:439</a></div></div>
<div class="ttc" id="helper__functions_8h_html"><div class="ttname"><a href="helper__functions_8h.html">helper_functions.h</a></div></div>
<div class="ttc" id="struct_handles_structures_html_a97111433048144dd5da6527ca88c8e0f"><div class="ttname"><a href="struct_handles_structures.html#a97111433048144dd5da6527ca88c8e0f">HandlesStructures::R2</a></div><div class="ttdeci">float R2</div><div class="ttdef"><b>Definition:</b> <a href="_handles_structures_8cuh_source.html#l00012">HandlesStructures.cuh:12</a></div></div>
<div class="ttc" id="_pike_reader_8m_html_ac0055fa4cdc19a2690bfee3643413a7d"><div class="ttname"><a href="_pike_reader_8m.html#ac0055fa4cdc19a2690bfee3643413a7d">V</a></div><div class="ttdeci">V</div><div class="ttdef"><b>Definition:</b> <a href="_pike_reader_8m_source.html#l00240">PikeReader.m:240</a></div></div>
<div class="ttc" id="_pike_reader_8m_html_ad30dfa987bf399e9d5c8256815544151"><div class="ttname"><a href="_pike_reader_8m.html#ad30dfa987bf399e9d5c8256815544151">Ka4</a></div><div class="ttdeci">Ka4</div><div class="ttdef"><b>Definition:</b> <a href="_pike_reader_8m_source.html#l00456">PikeReader.m:456</a></div></div>
<div class="ttc" id="struct_handles_structures_html_a2b8072df226d9ddcd0767c4247043770"><div class="ttname"><a href="struct_handles_structures.html#a2b8072df226d9ddcd0767c4247043770">HandlesStructures::efD</a></div><div class="ttdeci">float efD</div><div class="ttdef"><b>Definition:</b> <a href="_handles_structures_8cuh_source.html#l00010">HandlesStructures.cuh:10</a></div></div>
<div class="ttc" id="_pike_reader_8m_html_ae700af75f7c86d41107aff520471f509"><div class="ttname"><a href="_pike_reader_8m.html#ae700af75f7c86d41107aff520471f509">t</a></div><div class="ttdeci">t</div><div class="ttdef"><b>Definition:</b> <a href="_pike_reader_8m_source.html#l00246">PikeReader.m:246</a></div></div>
<div class="ttc" id="demosaic__mw_8m_html_a9d3d9048db16a7eee539e93e3618cbe7"><div class="ttname"><a href="demosaic__mw_8m.html#a9d3d9048db16a7eee539e93e3618cbe7">B</a></div><div class="ttdeci">B</div><div class="ttdef"><b>Definition:</b> <a href="demosaic__mw_8m_source.html#l00006">demosaic_mw.m:6</a></div></div>
<div class="ttc" id="_ray_tracing_8m_html_aa20240d26ace6829859aba913f892152"><div class="ttname"><a href="_ray_tracing_8m.html#aa20240d26ace6829859aba913f892152">P7</a></div><div class="ttdeci">P7</div><div class="ttdef"><b>Definition:</b> <a href="_ray_tracing_8m_source.html#l00107">RayTracing.m:107</a></div></div>
<div class="ttc" id="_pike_reader_8m_html_a580628da7b9cb7e817437cacb89c8300"><div class="ttname"><a href="_pike_reader_8m.html#a580628da7b9cb7e817437cacb89c8300">Ka2</a></div><div class="ttdeci">Ka2</div><div class="ttdef"><b>Definition:</b> <a href="_pike_reader_8m_source.html#l00452">PikeReader.m:452</a></div></div>
<div class="ttc" id="struct_handles_structures_html_ae99c25c83aa394b3e24d1d355d6fd8e3"><div class="ttname"><a href="struct_handles_structures.html#ae99c25c83aa394b3e24d1d355d6fd8e3">HandlesStructures::CCDW</a></div><div class="ttdeci">float CCDW</div><div class="ttdef"><b>Definition:</b> <a href="_handles_structures_8cuh_source.html#l00023">HandlesStructures.cuh:23</a></div></div>
<div class="ttc" id="_pike_reader_8m_html_a9008b30888cfe384af56bc71d2714dc1"><div class="ttname"><a href="_pike_reader_8m.html#a9008b30888cfe384af56bc71d2714dc1">Br</a></div><div class="ttdeci">Number of points per side Br</div><div class="ttdef"><b>Definition:</b> <a href="_pike_reader_8m_source.html#l00422">PikeReader.m:422</a></div></div>
<div class="ttc" id="struct_handles_structures_html_a3a8ce068f7b233ac206378f07e37334f"><div class="ttname"><a href="struct_handles_structures.html#a3a8ce068f7b233ac206378f07e37334f">HandlesStructures::PixSize</a></div><div class="ttdeci">float PixSize</div><div class="ttdef"><b>Definition:</b> <a href="_handles_structures_8cuh_source.html#l00021">HandlesStructures.cuh:21</a></div></div>
<div class="ttc" id="_pike_reader_8m_html_ad53a3643d8e9b1a361e497398d3d238c"><div class="ttname"><a href="_pike_reader_8m.html#ad53a3643d8e9b1a361e497398d3d238c">S</a></div><div class="ttdeci">handles S</div><div class="ttdef"><b>Definition:</b> <a href="_pike_reader_8m_source.html#l00043">PikeReader.m:43</a></div></div>
<div class="ttc" id="_pike_reader_8m_html_a350bfcb1e3cfb28ddff48ce525d4f139"><div class="ttname"><a href="_pike_reader_8m.html#a350bfcb1e3cfb28ddff48ce525d4f139">D</a></div><div class="ttdeci">D</div><div class="ttdef"><b>Definition:</b> <a href="_pike_reader_8m_source.html#l00245">PikeReader.m:245</a></div></div>
<div class="ttc" id="_pike_reader_8m_html_a7ecaf384ab87923ea947dbb29e4e4fa9"><div class="ttname"><a href="_pike_reader_8m.html#a7ecaf384ab87923ea947dbb29e4e4fa9">f</a></div><div class="ttdeci">end f</div><div class="ttdef"><b>Definition:</b> <a href="_pike_reader_8m_source.html#l00485">PikeReader.m:485</a></div></div>
<div class="ttc" id="_ray_tracing_8m_html_a2a792a898a039d36b908170327d38714"><div class="ttname"><a href="_ray_tracing_8m.html#a2a792a898a039d36b908170327d38714">p</a></div><div class="ttdeci">Snell s law if p</div><div class="ttdef"><b>Definition:</b> <a href="_ray_tracing_8m_source.html#l00127">RayTracing.m:127</a></div></div>
<div class="ttc" id="_ray_tracing_8m_html_a78d663047395fbda2ab172ef7d535a46"><div class="ttname"><a href="_ray_tracing_8m.html#a78d663047395fbda2ab172ef7d535a46">P5</a></div><div class="ttdeci">return end P5</div><div class="ttdef"><b>Definition:</b> <a href="_ray_tracing_8m_source.html#l00078">RayTracing.m:78</a></div></div>
<div class="ttc" id="_ray_tracing_8m_html_aee34fc740f3a5271508e6499ce2e3326"><div class="ttname"><a href="_ray_tracing_8m.html#aee34fc740f3a5271508e6499ce2e3326">X</a></div><div class="ttdeci">posledniaja toczka eto P5 X</div><div class="ttdef"><b>Definition:</b> <a href="_ray_tracing_8m_source.html#l00097">RayTracing.m:97</a></div></div>
<div class="ttc" id="_ray_tracing_8m_html_a0beaea967ea7920263f0580caccb0ed2"><div class="ttname"><a href="_ray_tracing_8m.html#a0beaea967ea7920263f0580caccb0ed2">v3</a></div><div class="ttdeci">Nachodim ugol mezdu normalju i vektorom padenia i stroim nowyj prelomlennyj wektor v3</div><div class="ttdef"><b>Definition:</b> <a href="_ray_tracing_8m_source.html#l00039">RayTracing.m:39</a></div></div>
<div class="ttc" id="_pike_reader_8m_html_a7e55b80aae57454b1b0353641cb67b33"><div class="ttname"><a href="_pike_reader_8m.html#a7e55b80aae57454b1b0353641cb67b33">Hi</a></div><div class="ttdeci">Hi</div><div class="ttdef"><b>Definition:</b> <a href="_pike_reader_8m_source.html#l00440">PikeReader.m:440</a></div></div>
<div class="ttc" id="struct_handles_structures_html_a0ab513238a5cafaacaab4b04ec5b3748"><div class="ttname"><a href="struct_handles_structures.html#a0ab513238a5cafaacaab4b04ec5b3748">HandlesStructures::l1</a></div><div class="ttdeci">float l1</div><div class="ttdef"><b>Definition:</b> <a href="_handles_structures_8cuh_source.html#l00015">HandlesStructures.cuh:15</a></div></div>
<div class="ttc" id="struct_handles_structures_html_ace7460e892f86901584256e61393e6e5"><div class="ttname"><a href="struct_handles_structures.html#ace7460e892f86901584256e61393e6e5">HandlesStructures::shY</a></div><div class="ttdeci">float shY</div><div class="ttdef"><b>Definition:</b> <a href="_handles_structures_8cuh_source.html#l00031">HandlesStructures.cuh:31</a></div></div>
<div class="ttc" id="struct_handles_structures_html_a4b889795c2b2b10970c49b1e0ded7918"><div class="ttname"><a href="struct_handles_structures.html#a4b889795c2b2b10970c49b1e0ded7918">HandlesStructures::g</a></div><div class="ttdeci">float g</div><div class="ttdef"><b>Definition:</b> <a href="_handles_structures_8cuh_source.html#l00013">HandlesStructures.cuh:13</a></div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_382e95b3446a02a720633edac7014b11.html">RayTracingCUDA_TJ</a></li><li class="navelem"><a class="el" href="_ray_trace_c_u_d_a__kernel_8cu.html">RayTraceCUDA_kernel.cu</a></li>
    <li class="footer">Wygenerowano So, 7 maj 2016 15:31:34 dla PikeReaderCUDA_TJ programem
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.6 </li>
  </ul>
</div>
</body>
</html>
